<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=v8lvo8q53i&amp;submodules=geocoder"></script>
    <script
      src="https://code.jquery.com/jquery-3.6.3.min.js"
      integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU="
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <div style="margin-top: 20px; margin-bottom: 10px; font-weight: bold">
      약국 지도
    </div>
    <div id="map" style="width: 100%; height: 500px"></div>
  </body>
  <script>
    $(document).ready(async () => {
      let XY = await getLocation();
      alert("위도" + XY.lat);
      alert("경도" + XY.lng);
      //지도를 삽입할 HTML 요소 또는 HTML 요소의 id를 지정합니다.
      let mapDiv = document.getElementById("map"); // 'map'으로 선언해도 동일

      //옵션 없이 지도 객체를 생성하면 서울 시청을 중심으로 하는 16 레벨의 지도가 생성됩니다.
      let map = new naver.maps.Map(mapDiv);
    });

    async function getLocation() {
      //async를 통해 getLocation 함수안에 비동기 구문이 있다고 표시해준다.
      let XY = new Object(); //객체 형태로 변수를 선언한다.
      if (navigator.geolocation) {
        //아래 promise를 통해 비동기를 동기로 바꿔준다.
        let promise = new Promise((resolve, rejected) => {
          //promise 변수는 getCurrentPosition을 가리킨다.
          navigator.geolocation.getCurrentPosition((position) => {
            resolve(position); //성공하였을 때 position객체를 반환해서 position 값이 성공하고난 다음에 반환된다.
          });
        });

        let position = await promise; // await를 통해 getCurrentPosition이 끝날때까지 기다려준다. 끝나고나면 position변수에 그 값이 들어와서 동기형태를 띈다.
        // navigator.geolocation.getCurrentPosition((position) => { 👋동기형태로 바꿨기 때문에 없애도 된다.
        //getCurrentPosition()은 비동기이기 때문에 아래 프로세스가 진행되는 도중에 리턴값이 반환되어버리기 때문에 동기형식으로 바꾼다.
        //현재의 위치를 gps로 알아낸다.
        position.coords.latitude; //위도
        position.coords.longitude; //경도
        XY.lat = position.coords.latitude; //XY.lat 변수에는 위도값 저장
        XY.lng = position.coords.longitude; //XY.lng 변수에는 경도값 저장
      }
      return XY;
    }
  </script>
</html>
